page = PAGE
page {
  10 = FLUIDTEMPLATE
  10 {
    ### Templates ###
    templateName = TEXT
    templateName.stdWrap {
      cObject = CASE
      cObject {

        key.data = pagelayout

        default = TEXT
        default.value = Default

        pagets__default = TEXT
        pagets__default.value = Default

        pagets__nobanner = TEXT
        pagets__nobanner.value = NoBanner
      }
    }

    ### Root Paths ###
    layoutRootPaths {
      10 = EXT:af6bus/Resources/Private/Layouts/
    }
    templateRootPaths {
      10 = EXT:af6bus/Resources/Private/Templates/
    }
    partialRootPaths {
      10 = EXT:af6bus/Resources/Private/Partials/
    }

    ### Variables ###
    variables {
      siteName = TEXT
      siteName.value = {siteLanguage:websiteTitle}
      siteName.insertData = 1
      homePid = TEXT
      homePid.value = {$homePid}
      footerPid = TEXT
      footerPid.value = {$footerPid}
      siteLogo = TEXT
      siteLogo.value = {$siteLogo}
    }

    ### Data Processing ###
    dataProcessing {
      # Main Navigation
      10 = TYPO3\CMS\Frontend\DataProcessing\DatabaseQueryProcessor
      10 {
        table = tt_content
        pidInList.field = uid
        where = sectionIndex = 1
        as = navigation
      }

      # Language Navigation
      20 = TYPO3\CMS\Frontend\DataProcessing\LanguageMenuProcessor
      20 {
        languages = auto
        as = navigationLanguage
      }

      # Meta Navigation
      30 = TYPO3\CMS\Frontend\DataProcessing\MenuProcessor
      30 {
        special = directory
        special.value = {$metaPid}
        as = navigationMeta

        dataProcessing {
          10 = files
          10 {
            references.fieldName = media
          }
        }
      }
    }
  }
}

lib.dynamicContent = COA
lib.dynamicContent {
  10 = LOAD_REGISTER
  10.colPos.cObject = TEXT
  10.colPos.cObject {
    field = colPos
    ifEmpty.cObject = TEXT
    ifEmpty.cObject {
      value.current = 1
      ifEmpty = 0
    }
  }
  20 = CONTENT
  20 {
    table = tt_content
    select {
      orderBy = sorting
      where = {#colPos}={register:colPos}
      where.insertData = 1
    }
  }
  30 = LOAD_REGISTER
  30.pid.cObject = TEXT
  30.pid.cObject {
    field = pid
    ifEmpty.cObject = TEXT
    ifEmpty.cObject {
      value.current = 1
    }
  }
  90 = RESTORE_REGISTER
}

## Banner-Template
tt_content {
  af6bus_banner =< lib.contentElement
  af6bus_banner {
    templateName = Banner

    templateRootPaths.100 = EXT:af6bus/Resources/Private/Templates/

    dataProcessing {
      10 = TYPO3\CMS\Frontend\DataProcessing\FilesProcessor
      10 {
        references.fieldName = assets
      }
    }
  }
}
